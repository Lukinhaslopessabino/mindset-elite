<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>Secure Admin Dashboard</title>

<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:'Orbitron',sans-serif;}

body{
background:#000;
color:#fff;
overflow:hidden;
display:flex;
justify-content:center;
align-items:center;
height:100vh;
}

canvas{
position:fixed;
top:0;
left:0;
z-index:-2;
}

.card{
width:500px;
padding:50px;
border-radius:25px;
background:rgba(0,0,0,0.85);
border:1px solid rgba(0,153,255,0.5);
box-shadow:0 0 50px rgba(0,153,255,0.8);
text-align:center;
}

h1 span{
color:#00BFFF;
text-shadow:0 0 20px #0099FF;
}

input{
width:100%;
padding:14px;
border-radius:12px;
border:1px solid #0099FF;
background:rgba(0,153,255,0.08);
color:#fff;
margin-bottom:15px;
}

button{
width:100%;
padding:14px;
border-radius:30px;
border:none;
background:linear-gradient(90deg,#0099FF,#00CFFF);
color:#fff;
cursor:pointer;
margin-bottom:10px;
}

button:hover{
box-shadow:0 0 30px #0099FF;
}

.status{
margin-top:15px;
min-height:20px;
}

.dashboard{
display:none;
margin-top:20px;
text-align:left;
}

.stats{
display:flex;
justify-content:space-between;
margin-bottom:20px;
}

.stat-box{
flex:1;
margin:5px;
padding:15px;
background:#111;
border-radius:10px;
border:1px solid #0099FF;
text-align:center;
}

.stat-box p{
font-size:22px;
color:#00ffcc;
}

.resultado{
background:#111;
padding:10px;
border-radius:10px;
max-height:200px;
overflow:auto;
font-size:12px;
margin-bottom:15px;
}

.delete-box{
margin-top:10px;
}
</style>
</head>

<body>

<canvas id="matrix"></canvas>

<div class="card">

<h1><span>Secure</span> Admin</h1>

<input type="password" id="senha" placeholder="Digite sua senha segura">

<button onclick="login()">Iniciar Verifica√ß√£o</button>

<div class="status" id="statusMsg"></div>

<div class="dashboard" id="dashboard">

<div class="stats">
<div class="stat-box">
<h3>Vagas</h3>
<p id="vagaCount">--</p>
</div>

<div class="stat-box">
<h3>Inscritos</h3>
<p id="inscritoCount">--</p>
</div>
</div>

<button onclick="verInscritos()">Ver Inscritos</button>
<button onclick="resetar()">Resetar Vaga</button>

<div class="resultado" id="resultado"></div>

<!-- üî• NOVA PARTE EXCLUIR -->
<div class="delete-box">
<input type="number" id="rankDelete" placeholder="Digite o # do ranking para excluir">
<button onclick="excluir()">Excluir por #</button>
</div>

</div>

</div>

<script>

/* LOGIN */
async function login(){

const senha = document.getElementById("senha").value;
const statusMsg = document.getElementById("statusMsg");
const dashboard = document.getElementById("dashboard");

statusMsg.innerHTML="Verificando...";

try{
const res = await fetch("/admin/login",{
method:"POST",
headers:{"Content-Type":"application/json"},
body: JSON.stringify({ senha })
});

if(!res.ok){
statusMsg.innerHTML="‚ùå Acesso Negado";
return;
}

statusMsg.innerHTML="‚úÖ Acesso Autorizado";

document.getElementById("senha").style.display="none";
document.querySelector("button").style.display="none";
statusMsg.style.display="none";

dashboard.style.display="block";

verInscritos();

}catch{
statusMsg.innerHTML="Erro de conex√£o.";
}

}

/* VER INSCRITOS */
async function verInscritos(){

const senha = document.getElementById("senha").value;

const res = await fetch("/admin/inscritos",{
method:"POST",
headers:{"Content-Type":"application/json"},
body: JSON.stringify({ senha })
});

const data = await res.json();

if(!res.ok){
alert("Erro ao buscar inscritos");
return;
}

document.getElementById("resultado").innerHTML =
"<pre>"+JSON.stringify(data.inscritos,null,2)+"</pre>";

document.getElementById("inscritoCount").innerText =
data.inscritos.length;

document.getElementById("vagaCount").innerText =
data.vagas;
}

/* RESETAR */
async function resetar(){

const senha = document.getElementById("senha").value;

await fetch("/admin/resetar",{
method:"POST",
headers:{"Content-Type":"application/json"},
body: JSON.stringify({ senha })
});

alert("Vaga resetada");
verInscritos();
}

/* üî• EXCLUIR POR RANK */
async function excluir(){

const senha = document.getElementById("senha").value;
const rank = parseInt(document.getElementById("rankDelete").value);

if(!rank){
alert("Digite o n√∫mero do ranking");
return;
}

const res = await fetch("/admin/excluir",{
method:"POST",
headers:{"Content-Type":"application/json"},
body: JSON.stringify({ senha, rank })
});

if(!res.ok){
alert("Erro ao excluir");
return;
}

alert("Membro exclu√≠do com sucesso");
verInscritos();
}

</script>

</body>
</html>

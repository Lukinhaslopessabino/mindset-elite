<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Painel Admin</title>
<style>
body{background:#000;color:#fff;font-family:sans-serif;text-align:center;padding:50px}
input,button{padding:10px;margin:10px;border-radius:8px;border:none}
button{background:#0099FF;color:#fff;cursor:pointer}
.box{background:#111;padding:20px;border-radius:15px;margin-top:20px}
</style>
</head>
<body>

<h1>Painel Admin</h1>

<input type="password" id="senha" placeholder="Senha admin">
<button onclick="login()">Entrar</button>

<div id="painel" style="display:none">

<div class="box">
<button onclick="verInscritos()">Ver Inscritos</button>
<button onclick="resetar()">Resetar Vaga para 1</button>
</div>

<div id="resultado"></div>

</div>

<script>

async function login(){
  const senha = document.getElementById("senha").value;

  const res = await fetch("/admin/login", {
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body: JSON.stringify({ senha })
  });

  if(!res.ok){
    alert("Senha incorreta");
    return;
  }

  document.getElementById("painel").style.display="block";
  alert("Login feito");
}

async function verInscritos(){
  const senha = document.getElementById("senha").value;

  const res = await fetch("/admin/inscritos", {
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body: JSON.stringify({ senha })
  });

  const data = await res.json();

  document.getElementById("resultado").innerHTML =
    "<pre>"+JSON.stringify(data.inscritos, null, 2)+"</pre>";
}

async function resetar(){
  const senha = document.getElementById("senha").value;

  await fetch("/admin/resetar", {
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body: JSON.stringify({ senha })
  });

  alert("Vaga resetada para 1");
}

</script>

</body>
</html>

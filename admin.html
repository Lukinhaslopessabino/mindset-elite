<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Mindset Admin</title>

<style>
body{
margin:0;
font-family:Arial;
background:#0b0f1a;
color:#fff;
}

.container{
padding:40px;
max-width:1200px;
margin:auto;
}

h1{
color:#00BFFF;
}

.login{
margin-bottom:30px;
}

input{
padding:12px;
border-radius:10px;
border:none;
background:#111;
color:#fff;
}

button{
padding:12px 20px;
border:none;
border-radius:10px;
background:linear-gradient(90deg,#0099FF,#00BFFF);
color:#fff;
cursor:pointer;
}

.cards{
display:grid;
grid-template-columns:repeat(auto-fit,minmax(250px,1fr));
gap:20px;
margin-top:30px;
}

.card{
background:rgba(0,153,255,0.08);
border:1px solid #0099FF;
border-radius:20px;
padding:30px;
box-shadow:0 0 20px rgba(0,153,255,0.2);
backdrop-filter:blur(10px);
transition:.3s;
}

.card:hover{
transform:translateY(-5px);
box-shadow:0 0 30px rgba(0,153,255,0.4);
}

.metric{
font-size:32px;
margin-top:10px;
color:#00BFFF;
}

.ip-list{
margin-top:40px;
}

.ip-item{
background:#111;
padding:15px;
margin-bottom:10px;
border-left:4px solid #0099FF;
display:flex;
justify-content:space-between;
align-items:center;
border-radius:10px;
}
</style>
</head>

<body>

<div class="container">

<h1>ðŸ§  Mindset Elite Admin</h1>

<div class="login">
<input type="password" id="senha" placeholder="Senha Admin">
<button onclick="carregar()">Entrar</button>
</div>

<div id="dashboard" style="display:none">

<div class="cards">
<div class="card">
<h3>Vagas Restantes</h3>
<div class="metric" id="vagas"></div>
</div>

<div class="card">
<h3>Total Inscritos</h3>
<div class="metric" id="inscritos"></div>
</div>

<div class="card">
<h3>IPs Bloqueados</h3>
<div class="metric" id="bloqueados"></div>
</div>
</div>

<div class="ip-list">
<h2>ðŸš« IPs Bloqueados</h2>
<div id="listaIPs"></div>
</div>

</div>

</div>

<script>
async function carregar(){
const senha = document.getElementById("senha").value;

const res = await fetch("/admin/dashboard",{
method:"POST",
headers:{ "Content-Type":"application/json"},
body: JSON.stringify({ senha })
});

const data = await res.json();

if(!res.ok){
alert(data.erro);
return;
}

document.getElementById("dashboard").style.display="block";

document.getElementById("vagas").innerText = data.vagas;
document.getElementById("inscritos").innerText = data.totalInscritos;
document.getElementById("bloqueados").innerText = data.totalBloqueados;

const lista = document.getElementById("listaIPs");
lista.innerHTML="";

data.bloqueados.forEach(item=>{
const div = document.createElement("div");
div.className="ip-item";
div.innerHTML = `
<span>${item.ip}</span>
<button onclick="desbloquear('${item.ip}')">Desbloquear</button>
`;
lista.appendChild(div);
});
}

async function desbloquear(ip){
const senha = document.getElementById("senha").value;

await fetch("/admin/desbloquear",{
method:"POST",
headers:{ "Content-Type":"application/json"},
body: JSON.stringify({ senha, ip })
});

carregar();
}
</script>

</body>
</html>
